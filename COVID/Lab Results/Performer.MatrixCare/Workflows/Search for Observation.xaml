<Activity mc:Ignorable="sap sap2010" x:Class="Search_for_Observation" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:el="clr-namespace:EZFramework.Logging;assembly=EZFramework" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:this="clr-namespace:" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="strResult" Type="InArgument(x:String)" />
    <x:Property Name="uiBrowserResident" Type="InArgument(ui:Browser)" />
    <x:Property Name="datetimeCollected" Type="InArgument(s:DateTime)" />
    <x:Property Name="strLab" Type="InArgument(x:String)" />
    <x:Property Name="strFullPathPage" Type="InArgument(x:String)" />
    <x:Property Name="strFailReason" Type="InOutArgument(x:String)" />
    <x:Property Name="datetimeResult" Type="InArgument(s:DateTime)" />
    <x:Property Name="dicConfig" Type="InArgument(scg:Dictionary(x:String, s:Tuple(x:String, x:String)))" />
    <x:Property Name="strStatusObservation" Type="OutArgument(x:String)" />
  </x:Members>
  <this:Search_for_Observation.strResult>
    <InArgument x:TypeArguments="x:String" />
  </this:Search_for_Observation.strResult>
  <this:Search_for_Observation.datetimeCollected>
    <InArgument x:TypeArguments="s:DateTime" />
  </this:Search_for_Observation.datetimeCollected>
  <this:Search_for_Observation.strLab>
    <InArgument x:TypeArguments="x:String" />
  </this:Search_for_Observation.strLab>
  <this:Search_for_Observation.strFullPathPage>
    <InArgument x:TypeArguments="x:String" />
  </this:Search_for_Observation.strFullPathPage>
  <this:Search_for_Observation.datetimeResult>
    <InArgument x:TypeArguments="s:DateTime" />
  </this:Search_for_Observation.datetimeResult>
  <this:Search_for_Observation.dicConfig>
    <InArgument x:TypeArguments="scg:Dictionary(x:String, s:Tuple(x:String, x:String))" />
  </this:Search_for_Observation.dicConfig>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1586,4304</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>Complete_Observation_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="21">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="27">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>UiPath.Word</AssemblyReference>
      <AssemblyReference>OfficeDevPnP.Core</AssemblyReference>
      <AssemblyReference>UiPathTeam.SharePoint</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="Search for Observation" sap:VirtualizedContainerService.HintSize="1596,4199" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="1554,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_1" LogLevel="Info" LogMessage="Checking for pending Observation...." />
    <ui:BrowserScope SearchScope="{x:Null}" Selector="{x:Null}" TimeoutMS="{x:Null}" UiBrowser="{x:Null}" Browser="[uiBrowserResident]" BrowserType="Chrome" DisplayName="Attach Browser 'MatrixCare: Observations'" sap:VirtualizedContainerService.HintSize="1554,4045" sap2010:WorkflowViewState.IdRef="BrowserScope_2">
      <ui:BrowserScope.Body>
        <ActivityAction x:TypeArguments="x:Object">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Check for Pending Observation" sap:VirtualizedContainerService.HintSize="1520,3937" sap2010:WorkflowViewState.IdRef="Sequence_14">
            <Sequence.Variables>
              <Variable x:TypeArguments="scg:IEnumerable(ui:UiElement)" Name="arruiChildrenTable" />
              <Variable x:TypeArguments="x:Int32" Name="intDaysDateCollected" />
              <Variable x:TypeArguments="x:String" Name="strDateCollected" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:NavigateTo Browser="{x:Null}" DisplayName="Navigate To: Observations" sap:VirtualizedContainerService.HintSize="1478,59" sap2010:WorkflowViewState.IdRef="NavigateTo_4" Url="https://cardon.matrixcare.com/observationListView.action?actionPageAlias=OBSERVATIONLISTVIEWACTION&amp;zionpagealias=OBSERVATIONLISTVIEWACTION" />
            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="1478,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_7">
              <ui:MultipleAssign.AssignOperations>
                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_14">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strDateCollected]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[datetimeCollected.ToString("MM/dd/yyyy")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_15">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="scg:IEnumerable(ui:UiElement)">[arruiChildrenTable]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="scg:IEnumerable(ui:UiElement)">[New UiElement() {}]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_16">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:Int32">[intDaysDateCollected]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:Int32">[CInt(dicConfig("Span.Days.DateCollected").Item2)]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                </scg:List>
              </ui:MultipleAssign.AssignOperations>
            </ui:MultipleAssign>
            <ui:FindChildren Children="[arruiChildrenTable]" DisplayName="Find Children 'COVID Testing'" Filter="&lt;webctrl innertext='*COVID-19*'/&gt;" sap:VirtualizedContainerService.HintSize="1478,68" sap2010:WorkflowViewState.IdRef="FindChildren_4" Scope="FIND_CHILDREN">
              <ui:FindChildren.Target>
                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="94a1f791-09d8-44d5-8f4d-a09a0460297a" Selector="&lt;webctrl tag='TABLE' /&gt;&lt;webctrl css-selector='body&amp;gt;div&amp;gt;div&amp;gt;main&amp;gt;div&amp;gt;div&amp;gt;table&amp;gt;tbody' tag='TBODY' /&gt;">
                  <ui:Target.TimeoutMS>
                    <InArgument x:TypeArguments="x:Int32" />
                  </ui:Target.TimeoutMS>
                  <ui:Target.WaitForReady>
                    <InArgument x:TypeArguments="ui:WaitForReady" />
                  </ui:Target.WaitForReady>
                </ui:Target>
              </ui:FindChildren.Target>
            </ui:FindChildren>
            <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="1478,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_8">
              <ui:MultipleAssign.AssignOperations>
                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_17">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="scg:IEnumerable(ui:UiElement)">[arruiChildrenTable]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="scg:IEnumerable(ui:UiElement)">[arruiChildrenTable.Where(Function(item) item.Get("innertext").ToString.Contains(strDateCollected) Or item.Get("innertext").ToString.Contains(DateTime.Parse(strDateCollected).AddDays(Math.Abs(intDaysDateCollected) * -1).ToString("MM/dd/yyyy"))).ToArray()]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                </scg:List>
              </ui:MultipleAssign.AssignOperations>
            </ui:MultipleAssign>
            <If Condition="[arruiChildrenTable.Count &gt; 0]" DisplayName="If: Observations Exists" sap:VirtualizedContainerService.HintSize="1478,3238" sap2010:WorkflowViewState.IdRef="If_7">
              <If.Then>
                <ui:ForEach x:TypeArguments="ui:UiElement" CurrentIndex="{x:Null}" DisplayName="For Each: COVID Test" sap:VirtualizedContainerService.HintSize="1333,3091" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[arruiChildrenTable]">
                  <ui:ForEach.Body>
                    <ActivityAction x:TypeArguments="ui:UiElement">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="ui:UiElement" Name="uiele" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Check Date Collected" sap:VirtualizedContainerService.HintSize="1297,2958" sap2010:WorkflowViewState.IdRef="Sequence_13">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:IEnumerable(ui:UiElement)" Name="arruiTest" />
                          <Variable x:TypeArguments="x:String" Name="strTableRow" />
                          <Variable x:TypeArguments="x:Boolean" Name="boolCompleted" />
                          <Variable x:TypeArguments="x:String" Name="strDateObservation" />
                          <Variable x:TypeArguments="s:DateTime" Name="datetimeObservation" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:FindChildren Children="[arruiTest]" DisplayName="Find Children 'Test Row'" Filter="&lt;webctrl colName='*Description*' /&gt;" sap:VirtualizedContainerService.HintSize="1255,68" sap2010:WorkflowViewState.IdRef="FindChildren_5" Scope="FIND_CHILDREN">
                          <ui:FindChildren.Target>
                            <ui:Target ClippingRegion="{x:Null}" Selector="{x:Null}" Element="[uiele]" Id="83dda2d0-0de9-4db9-b2c0-0146ffcf6dea">
                              <ui:Target.TimeoutMS>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:Target.TimeoutMS>
                              <ui:Target.WaitForReady>
                                <InArgument x:TypeArguments="ui:WaitForReady" />
                              </ui:Target.WaitForReady>
                            </ui:Target>
                          </ui:FindChildren.Target>
                        </ui:FindChildren>
                        <ui:GetAttribute ContinueOnError="{x:Null}" Attribute="tableRow" DisplayName="Get Attribute: Element's Row" sap:VirtualizedContainerService.HintSize="1255,96" sap2010:WorkflowViewState.IdRef="GetAttribute_3">
                          <ui:GetAttribute.Result>
                            <OutArgument x:TypeArguments="x:String">[strTableRow]</OutArgument>
                          </ui:GetAttribute.Result>
                          <ui:GetAttribute.Target>
                            <ui:Target ClippingRegion="{x:Null}" Selector="{x:Null}" Element="[arruiTest.First()]" Id="1e755237-1f2e-42e5-b7a1-0822aafea6bf">
                              <ui:Target.TimeoutMS>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:Target.TimeoutMS>
                              <ui:Target.WaitForReady>
                                <InArgument x:TypeArguments="ui:WaitForReady" />
                              </ui:Target.WaitForReady>
                            </ui:Target>
                          </ui:GetAttribute.Target>
                        </ui:GetAttribute>
                        <ui:GetAttribute ContinueOnError="{x:Null}" Attribute="innerText" DisplayName="Get Attribute: Observation Date" sap:VirtualizedContainerService.HintSize="1255,96" sap2010:WorkflowViewState.IdRef="GetAttribute_4">
                          <ui:GetAttribute.Result>
                            <OutArgument x:TypeArguments="x:String">[strDateObservation]</OutArgument>
                          </ui:GetAttribute.Result>
                          <ui:GetAttribute.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="1e755237-1f2e-42e5-b7a1-0822aafea6bf" Selector="[&quot;&lt;webctrl tag='TABLE' /&gt;&lt;webctrl tag='TD' colName='Date/Time*' tableRow='&quot; + strTableRow + &quot;' /&gt;&quot;]">
                              <ui:Target.TimeoutMS>
                                <InArgument x:TypeArguments="x:Int32" />
                              </ui:Target.TimeoutMS>
                              <ui:Target.WaitForReady>
                                <InArgument x:TypeArguments="ui:WaitForReady" />
                              </ui:Target.WaitForReady>
                            </ui:Target>
                          </ui:GetAttribute.Target>
                        </ui:GetAttribute>
                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="1255,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_9">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_18">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="s:DateTime">[datetimeObservation]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="s:DateTime">[DateTime.Parse(strDateObservation.Trim())]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <ui:UiElementExists DisplayName="Element Exists: Completed" Exists="[boolCompleted]" sap:VirtualizedContainerService.HintSize="1255,68" sap2010:WorkflowViewState.IdRef="UiElementExists_2">
                          <ui:UiElementExists.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="5cb6eb96-fb1d-4575-8c0e-4556dd5e75bc" Selector="[&quot;&lt;webctrl isleaf='1' tableRow='&quot; + strTableRow + &quot;' tag='SPAN' class='fa fa-check neo-success' /&gt;&quot;]" TimeoutMS="1000">
                              <ui:Target.WaitForReady>
                                <InArgument x:TypeArguments="ui:WaitForReady" />
                              </ui:Target.WaitForReady>
                            </ui:Target>
                          </ui:UiElementExists.Target>
                        </ui:UiElementExists>
                        <If Condition="[datetimeObservation.Date &lt;= datetimeCollected.Date And datetimeObservation.Date &gt;= datetimeCollected.Date.AddDays(Math.Abs(intDaysDateCollected) * -1)]" DisplayName="If: Within DateCollected Params" sap:VirtualizedContainerService.HintSize="1255,2240" sap2010:WorkflowViewState.IdRef="If_6">
                          <If.Then>
                            <Sequence DisplayName="Click Observation" sap:VirtualizedContainerService.HintSize="1110,2093" sap2010:WorkflowViewState.IdRef="Sequence_11">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="ui:Browser" Name="uiBrowserObservation" />
                              </Sequence.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="1068,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_7" LogLevel="Info" LogMessage="Checking a pending Observation..." />
                              <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Observation'" sap:VirtualizedContainerService.HintSize="1068,68" sap2010:WorkflowViewState.IdRef="Click_4" KeyModifiers="Ctrl" MouseButton="BTN_LEFT">
                                <ui:Click.CursorPosition>
                                  <ui:CursorPosition Position="Center">
                                    <ui:CursorPosition.OffsetX>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetX>
                                    <ui:CursorPosition.OffsetY>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetY>
                                  </ui:CursorPosition>
                                </ui:Click.CursorPosition>
                                <ui:Click.Target>
                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="ca79945d-fa3f-459a-b429-aedefb69e63f" Selector="[&quot;&lt;webctrl tag='A' colName='*Description*' tableRow='&quot; + strTableRow + &quot;' /&gt;&quot;]">
                                    <ui:Target.TimeoutMS>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:Target.TimeoutMS>
                                    <ui:Target.WaitForReady>
                                      <InArgument x:TypeArguments="ui:WaitForReady" />
                                    </ui:Target.WaitForReady>
                                  </ui:Target>
                                </ui:Click.Target>
                              </ui:Click>
                              <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" TimeoutMS="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'Observation'" sap:VirtualizedContainerService.HintSize="1068,1831" sap2010:WorkflowViewState.IdRef="BrowserScope_3" Selector="&lt;html app='chrome.exe' url='*cardon.matrixcare.com/Zion?zionpagealias=CHARTVIEW*' /&gt;" UiBrowser="[uiBrowserObservation]">
                                <ui:BrowserScope.Body>
                                  <ActivityAction x:TypeArguments="x:Object">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Check Observation" sap:VirtualizedContainerService.HintSize="1034,1723" sap2010:WorkflowViewState.IdRef="Sequence_20">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="x:Boolean" Name="boolCheckedPCR" />
                                        <Variable x:TypeArguments="x:String" Name="strCheckCompletionDate" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:RetryScope DisplayName="Retry Scope: Expand Observations" sap:VirtualizedContainerService.HintSize="992,295" sap2010:WorkflowViewState.IdRef="RetryScope_2" NumberOfRetries="5" RetryInterval="00:00:00">
                                        <ui:RetryScope.ActivityBody>
                                          <ActivityAction>
                                            <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Expand Observation'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="Click_8" KeyModifiers="None" MouseButton="BTN_LEFT" SimulateClick="True">
                                              <ui:Click.CursorPosition>
                                                <ui:CursorPosition Position="Center">
                                                  <ui:CursorPosition.OffsetX>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:CursorPosition.OffsetX>
                                                  <ui:CursorPosition.OffsetY>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:CursorPosition.OffsetY>
                                                </ui:CursorPosition>
                                              </ui:Click.CursorPosition>
                                              <ui:Click.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="f3418444-4ca6-4039-a3b6-b4a6155a6c33" Selector="&lt;webctrl id='EXPAND_FORM' tag='IMG' /&gt;">
                                                  <ui:Target.TimeoutMS>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:Target.TimeoutMS>
                                                  <ui:Target.WaitForReady>
                                                    <InArgument x:TypeArguments="ui:WaitForReady" />
                                                  </ui:Target.WaitForReady>
                                                </ui:Target>
                                              </ui:Click.Target>
                                            </ui:Click>
                                          </ActivityAction>
                                        </ui:RetryScope.ActivityBody>
                                        <ui:RetryScope.Condition>
                                          <ActivityFunc x:TypeArguments="x:Boolean">
                                            <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="UiElementExists_4">
                                              <ui:UiElementExists.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="f7dba4bb-f4ab-46d8-8a05-a4b5a3d9ddb9" Selector="&lt;webctrl aaname='PCR*' parentid='TR_*' tag='SPAN' /&gt;">
                                                  <ui:Target.TimeoutMS>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:Target.TimeoutMS>
                                                  <ui:Target.WaitForReady>
                                                    <InArgument x:TypeArguments="ui:WaitForReady" />
                                                  </ui:Target.WaitForReady>
                                                </ui:Target>
                                              </ui:UiElementExists.Target>
                                            </ui:UiElementExists>
                                          </ActivityFunc>
                                        </ui:RetryScope.Condition>
                                      </ui:RetryScope>
                                      <ui:AnchorBase AnchorPosition="Right" DisplayName="Anchor Base: Type" sap:VirtualizedContainerService.HintSize="992,188" sap2010:WorkflowViewState.IdRef="AnchorBase_2">
                                        <ui:AnchorBase.Action>
                                          <ActivityAction x:TypeArguments="ui:Anchor">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="ui:Anchor" Name="ContextAnchor" />
                                            </ActivityAction.Argument>
                                            <ui:GetAttribute ContinueOnError="{x:Null}" Attribute="checked" DisplayName="Get Attribute 'Checked Status'" sap:VirtualizedContainerService.HintSize="334,96" sap2010:WorkflowViewState.IdRef="GetAttribute_6">
                                              <ui:GetAttribute.Result>
                                                <OutArgument x:TypeArguments="x:Boolean">[boolCheckedPCR]</OutArgument>
                                              </ui:GetAttribute.Result>
                                              <ui:GetAttribute.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="29f254c9-e199-42a2-b6f1-34870fd48f29" Selector="&lt;webctrl tag='INPUT' /&gt;">
                                                  <ui:Target.TimeoutMS>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:Target.TimeoutMS>
                                                  <ui:Target.WaitForReady>
                                                    <InArgument x:TypeArguments="ui:WaitForReady" />
                                                  </ui:Target.WaitForReady>
                                                </ui:Target>
                                              </ui:GetAttribute.Target>
                                            </ui:GetAttribute>
                                          </ActivityAction>
                                        </ui:AnchorBase.Action>
                                        <ui:AnchorBase.AnchorProvider>
                                          <ui:WaitUiElementAppear FoundElement="{x:Null}" WaitActive="{x:Null}" WaitVisible="{x:Null}" DisplayName="Find Element 'Type of Test'" sap:VirtualizedContainerService.HintSize="334,68" sap2010:WorkflowViewState.IdRef="WaitUiElementAppear_3">
                                            <ui:WaitUiElementAppear.Target>
                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="0cb679f8-fb6b-4e78-ac89-0647de6a7488" Selector="&lt;webctrl aaname='PCR*' parentid='TR_*' tag='SPAN' /&gt;">
                                                <ui:Target.TimeoutMS>
                                                  <InArgument x:TypeArguments="x:Int32" />
                                                </ui:Target.TimeoutMS>
                                                <ui:Target.WaitForReady>
                                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                                </ui:Target.WaitForReady>
                                              </ui:Target>
                                            </ui:WaitUiElementAppear.Target>
                                          </ui:WaitUiElementAppear>
                                        </ui:AnchorBase.AnchorProvider>
                                      </ui:AnchorBase>
                                      <If Condition="[boolCheckedPCR]" DisplayName="If: Test is PCR" sap:VirtualizedContainerService.HintSize="992,1006" sap2010:WorkflowViewState.IdRef="If_10">
                                        <If.Then>
                                          <Sequence DisplayName="Check PCR Completion" sap:VirtualizedContainerService.HintSize="847,859" sap2010:WorkflowViewState.IdRef="Sequence_19">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:GetAttribute ContinueOnError="{x:Null}" Attribute="innerText" DisplayName="Get Attribute 'Completion Date'" sap:VirtualizedContainerService.HintSize="805,96" sap2010:WorkflowViewState.IdRef="GetAttribute_7">
                                              <ui:GetAttribute.Result>
                                                <OutArgument x:TypeArguments="x:String">[strCheckCompletionDate]</OutArgument>
                                              </ui:GetAttribute.Result>
                                              <ui:GetAttribute.Target>
                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="29f254c9-e199-42a2-b6f1-34870fd48f29" Selector="&lt;webctrl parentid='displayObservationId' tag='TABLE' rowName='Type of Test*' /&gt;&lt;webctrl tag='TD' colName='Type of test  ' rowName='Date of results*' /&gt;">
                                                  <ui:Target.TimeoutMS>
                                                    <InArgument x:TypeArguments="x:Int32" />
                                                  </ui:Target.TimeoutMS>
                                                  <ui:Target.WaitForReady>
                                                    <InArgument x:TypeArguments="ui:WaitForReady" />
                                                  </ui:Target.WaitForReady>
                                                </ui:Target>
                                              </ui:GetAttribute.Target>
                                            </ui:GetAttribute>
                                            <If Condition="[String.IsNullOrWhitespace(strCheckCompletionDate)]" DisplayName="If: No Date in Completed" sap:VirtualizedContainerService.HintSize="805,631" sap2010:WorkflowViewState.IdRef="If_9">
                                              <If.Then>
                                                <Sequence DisplayName="Set Valid Observation" sap:VirtualizedContainerService.HintSize="380,484" sap2010:WorkflowViewState.IdRef="Sequence_17">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_10" LogLevel="Info" LogMessage="Pending Observation found!" />
                                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_12">
                                                    <ui:MultipleAssign.AssignOperations>
                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_22">
                                                          <ui:AssignOperation.To>
                                                            <OutArgument x:TypeArguments="x:String">[strStatusObservation]</OutArgument>
                                                          </ui:AssignOperation.To>
                                                          <ui:AssignOperation.Value>
                                                            <InArgument x:TypeArguments="x:String">Pending</InArgument>
                                                          </ui:AssignOperation.Value>
                                                        </ui:AssignOperation>
                                                      </scg:List>
                                                    </ui:MultipleAssign.AssignOperations>
                                                  </ui:MultipleAssign>
                                                  <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'View/Update'" sap:VirtualizedContainerService.HintSize="338,68" sap2010:WorkflowViewState.IdRef="Click_9" KeyModifiers="Ctrl" MouseButton="BTN_LEFT">
                                                    <ui:Click.CursorPosition>
                                                      <ui:CursorPosition Position="Center">
                                                        <ui:CursorPosition.OffsetX>
                                                          <InArgument x:TypeArguments="x:Int32" />
                                                        </ui:CursorPosition.OffsetX>
                                                        <ui:CursorPosition.OffsetY>
                                                          <InArgument x:TypeArguments="x:Int32" />
                                                        </ui:CursorPosition.OffsetY>
                                                      </ui:CursorPosition>
                                                    </ui:Click.CursorPosition>
                                                    <ui:Click.Target>
                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="7e013198-e6db-4d94-b8d8-69bffabda9c8" Selector="&lt;webctrl name='editview' tag='INPUT' /&gt;">
                                                        <ui:Target.TimeoutMS>
                                                          <InArgument x:TypeArguments="x:Int32" />
                                                        </ui:Target.TimeoutMS>
                                                        <ui:Target.WaitForReady>
                                                          <InArgument x:TypeArguments="ui:WaitForReady" />
                                                        </ui:Target.WaitForReady>
                                                      </ui:Target>
                                                    </ui:Click.Target>
                                                  </ui:Click>
                                                  <ui:CloseTab Browser="{x:Null}" ContinueOnError="True" DisplayName="Close Tab" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="CloseTab_6" />
                                                  <ui:Break sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="Break_5" />
                                                </Sequence>
                                              </If.Then>
                                              <If.Else>
                                                <Sequence DisplayName="Observation already Completed" sap:VirtualizedContainerService.HintSize="380,376" sap2010:WorkflowViewState.IdRef="Sequence_18">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_11" LogLevel="Warn" LogMessage="Observation may already be completed!" />
                                                  <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_13">
                                                    <ui:MultipleAssign.AssignOperations>
                                                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_23">
                                                          <ui:AssignOperation.To>
                                                            <OutArgument x:TypeArguments="x:String">[strStatusObservation]</OutArgument>
                                                          </ui:AssignOperation.To>
                                                          <ui:AssignOperation.Value>
                                                            <InArgument x:TypeArguments="x:String">Exists</InArgument>
                                                          </ui:AssignOperation.Value>
                                                        </ui:AssignOperation>
                                                      </scg:List>
                                                    </ui:MultipleAssign.AssignOperations>
                                                  </ui:MultipleAssign>
                                                  <ui:CloseTab Browser="{x:Null}" ContinueOnError="True" DisplayName="Close Tab" sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="CloseTab_7" />
                                                  <ui:Break sap:VirtualizedContainerService.HintSize="338,22" sap2010:WorkflowViewState.IdRef="Break_6" />
                                                </Sequence>
                                              </If.Else>
                                            </If>
                                          </Sequence>
                                        </If.Then>
                                      </If>
                                      <ui:CloseTab Browser="{x:Null}" ContinueOnError="True" DisplayName="Close Tab" sap:VirtualizedContainerService.HintSize="992,22" sap2010:WorkflowViewState.IdRef="CloseTab_8" />
                                    </Sequence>
                                  </ActivityAction>
                                </ui:BrowserScope.Body>
                              </ui:BrowserScope>
                            </Sequence>
                          </If.Then>
                        </If>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEach.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ForEach>
              </If.Then>
            </If>
            <ui:CloseTab Browser="{x:Null}" ContinueOnError="True" DisplayName="Close Tab" sap:VirtualizedContainerService.HintSize="1478,22" sap2010:WorkflowViewState.IdRef="CloseTab_2" />
          </Sequence>
        </ActivityAction>
      </ui:BrowserScope.Body>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:BrowserScope>
  </Sequence>
</Activity>