<Activity mc:Ignorable="sap sap2010" x:Class="Extract_Result_Data" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:ed="clr-namespace:EZFramework.Directories;assembly=EZFramework" xmlns:el="clr-namespace:EZFramework.Logging;assembly=EZFramework" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:si="clr-namespace:System.IO;assembly=mscorlib" xmlns:this="clr-namespace:" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="dtNewResults" Type="InArgument(sd:DataTable)" />
    <x:Property Name="uiBrowserSolaris" Type="InArgument(ui:Browser)" />
    <x:Property Name="dicConfig" Type="InArgument(scg:Dictionary(x:String, s:Tuple(x:String, x:String)))" />
    <x:Property Name="strQueueNameDispatcher" Type="InArgument(x:String)" />
    <x:Property Name="listExceptions" Type="InOutArgument(scg:List(scg:KeyValuePair(x:String, x:String)))" />
    <x:Property Name="strPathProcessedResults" Type="InArgument(x:String)" />
  </x:Members>
  <this:Extract_Result_Data.uiBrowserSolaris>
    <InArgument x:TypeArguments="ui:Browser" />
  </this:Extract_Result_Data.uiBrowserSolaris>
  <this:Extract_Result_Data.dicConfig>
    <InArgument x:TypeArguments="scg:Dictionary(x:String, s:Tuple(x:String, x:String))" />
  </this:Extract_Result_Data.dicConfig>
  <this:Extract_Result_Data.strPathProcessedResults>
    <InArgument x:TypeArguments="x:String" />
  </this:Extract_Result_Data.strPathProcessedResults>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1582,6179</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>Extract_Result_Data_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="25">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="28">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.Data.Entity</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>UiPath.Word</AssemblyReference>
      <AssemblyReference>OfficeDevPnP.Core</AssemblyReference>
      <AssemblyReference>UiPathTeam.SharePoint</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="Extract_Result_Data" sap:VirtualizedContainerService.HintSize="1592,6074" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="scg:List(x:String)" Name="listInvalidNames" />
      <Variable x:TypeArguments="sd:DataTable" Name="dtDispatchedResult" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="1550,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_1" LogLevel="Info" LogMessage="Extracting New Results Data..." />
    <ui:MultipleAssign DisplayName="Multiple Assign: Declarations" sap:VirtualizedContainerService.HintSize="1550,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
      <ui:MultipleAssign.AssignOperations>
        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_1">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="scg:List(x:String)">[listInvalidNames]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="scg:List(x:String)">[New List(of String) From {"ii", "iii", "iv", "cpa", "dds", "esq", "jd", "jr", "lld", "md", "phd", "ret", "rn", "sr", "do", "dr", "atty", "mr", "ms", "mrs"}]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_60">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="sd:DataTable">[dtDispatchedResult]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="sd:DataTable">[New DataTable()]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_61">
            <ui:AssignOperation.To>
              <OutArgument x:TypeArguments="sd:DataTable">[dtDispatchedResult]</OutArgument>
            </ui:AssignOperation.To>
            <ui:AssignOperation.Value>
              <InArgument x:TypeArguments="sd:DataTable">[dtNewResults.Clone()]</InArgument>
            </ui:AssignOperation.Value>
          </ui:AssignOperation>
        </scg:List>
      </ui:MultipleAssign.AssignOperations>
    </ui:MultipleAssign>
    <TryCatch DisplayName="Try Catch: Dispatch Results" sap:VirtualizedContainerService.HintSize="1550,5720" sap2010:WorkflowViewState.IdRef="TryCatch_2">
      <TryCatch.Variables>
        <Variable x:TypeArguments="x:Int32" Name="intIndex" />
      </TryCatch.Variables>
      <TryCatch.Try>
        <ui:BrowserScope SearchScope="{x:Null}" Selector="{x:Null}" TimeoutMS="{x:Null}" UiBrowser="{x:Null}" Browser="[uiBrowserSolaris]" BrowserType="Chrome" DisplayName="Attach Browser: Solaris" sap:VirtualizedContainerService.HintSize="1512,5493" sap2010:WorkflowViewState.IdRef="BrowserScope_1">
          <ui:BrowserScope.Body>
            <ActivityAction x:TypeArguments="x:Object">
              <ActivityAction.Argument>
                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
              </ActivityAction.Argument>
              <ui:ForEachRow CurrentIndex="[intIndex]" DataTable="[dtNewResults]" DisplayName="For Each Row: New Result" sap:VirtualizedContainerService.HintSize="1478,5385" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                <ui:ForEachRow.Body>
                  <ActivityAction x:TypeArguments="sd:DataRow">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                    </ActivityAction.Argument>
                    <Sequence DisplayName="Extract Each Row Data" sap:VirtualizedContainerService.HintSize="1428,5238" sap2010:WorkflowViewState.IdRef="Sequence_14">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:String" Name="strFirstName" />
                        <Variable x:TypeArguments="x:String" Name="strLastName" />
                        <Variable x:TypeArguments="x:String" Name="strContactDOB" />
                        <Variable x:TypeArguments="x:String" Name="strDateCollected" />
                        <Variable x:TypeArguments="x:String" Name="strDateResult" />
                        <Variable x:TypeArguments="x:String" Name="strResult" />
                        <Variable x:TypeArguments="s:String[]" Name="arrFullName" />
                        <Variable x:TypeArguments="x:String" Name="strRID" />
                        <Variable x:TypeArguments="x:String" Name="strContactFacility" />
                        <Variable x:TypeArguments="x:String" Name="strContactType" />
                        <Variable x:TypeArguments="x:String" Name="strPathSaves" />
                        <Variable x:TypeArguments="s:DateTime" Name="datetimeCollected" />
                        <Variable x:TypeArguments="s:DateTime" Name="datetimeResult" />
                        <Variable x:TypeArguments="x:String" Name="strItemId" />
                        <Variable x:TypeArguments="x:String" Name="strLab" />
                        <Variable x:TypeArguments="x:String" Name="strSuccessMessage" />
                        <Variable x:TypeArguments="x:String" Name="strStatus" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Sequence DisplayName="Check for Stop" sap:VirtualizedContainerService.HintSize="1386,477" sap2010:WorkflowViewState.IdRef="Sequence_23">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:Boolean" Name="boolStop" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:ShouldStop DisplayName="Should Stop" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="ShouldStop_1" Result="[boolStop]" />
                        <If Condition="[boolStop]" DisplayName="If: Stop Requested" sap:VirtualizedContainerService.HintSize="484,323" sap2010:WorkflowViewState.IdRef="If_4">
                          <If.Then>
                            <Sequence DisplayName="Stop Requested" sap:VirtualizedContainerService.HintSize="242,176" sap2010:WorkflowViewState.IdRef="Sequence_24">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_17" LogLevel="Warn" LogMessage="Stop requested!" />
                              <ui:Break sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Break_1" />
                            </Sequence>
                          </If.Then>
                        </If>
                      </Sequence>
                      <ui:MultipleAssign DisplayName="Multiple Assign: Row Data" sap:VirtualizedContainerService.HintSize="1386,594" sap2010:WorkflowViewState.IdRef="MultipleAssign_6">
                        <ui:MultipleAssign.AssignOperations>
                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="32">
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_29">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="s:String[]">[arrFullName]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="s:String[]">[row("Patient Name").ToString.Replace(".", "").Split(" "c)]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_62">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="s:String[]">[arrFullName]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="s:String[]">[arrFullName.Where(Function(item) Not listInvalidNames.Any(Function(value) item.Trim.Equals(value))).ToArray()]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_30">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strFirstName]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[StrConv(arrFullName.First(), vbProperCase)]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_31">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strLastName]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[StrConv(arrFullName.Last(), vbProperCase)]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_32">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strContactDOB]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[row("DOB").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_33">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strContactFacility]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[row("Client Site").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_34">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strContactType]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[If (strContactFacility.Trim.ToLower.Contains("resident"), "Resident", "Staff")]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_35">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strRID]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[row("RID").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_36">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strDateCollected]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[row("Collection Date").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_37">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="s:DateTime">[datetimeCollected]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="s:DateTime">[DateTime.Parse(strDateCollected)]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_38">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strDateResult]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[row("Approved Date").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_39">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="s:DateTime">[datetimeResult]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="s:DateTime">[DateTime.Parse(strDateResult)]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_63">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strStatus]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[row("Status").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_40">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strResult]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[row("nCov2019").ToString]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_41">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strLab]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">Solaris</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_42">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strItemId]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[String.Join("_", {strLab, strRID})]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_57">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[strPathSaves]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String" xml:space="preserve">[dicConfig("Path.ScanExtract."  + strContactType).Item2.Replace("%USERNAME%", Environment.Username)]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                          </scg:List>
                        </ui:MultipleAssign.AssignOperations>
                      </ui:MultipleAssign>
                      <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="1386,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_7" LogLevel="Info" LogMessage="[&quot;Processing [&quot; + String.Join(&quot;] [&quot;, {strContactType, strStatus, strFirstName, strLastName, strContactDOB, strRID, strDateCollected, strResult, strDateResult}) + &quot;]...&quot;]" />
                      <ui:RetryScope DisplayName="Retry Scope: Extract Data and Add to Dispatcher" sap:VirtualizedContainerService.HintSize="1386,3933" sap2010:WorkflowViewState.IdRef="RetryScope_1" NumberOfRetries="3" RetryInterval="00:00:05">
                        <ui:RetryScope.ActivityBody>
                          <ActivityAction>
                            <TryCatch DisplayName="Try Catch: Extract Data and Add to Dispatcher" sap:VirtualizedContainerService.HintSize="1344,3759" sap2010:WorkflowViewState.IdRef="TryCatch_1">
                              <TryCatch.Try>
                                <Sequence DisplayName="Extract Data and Add to Dispatcher" sap:VirtualizedContainerService.HintSize="1306,3532" sap2010:WorkflowViewState.IdRef="Sequence_8">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="x:String" Name="strFullPathPage" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If Condition="[Not strStatus.ToLower.Equals(&quot;rejected&quot;)]" DisplayName="If: Not Rejected" sap:VirtualizedContainerService.HintSize="1264,1835" sap2010:WorkflowViewState.IdRef="If_5">
                                    <If.Then>
                                      <Sequence DisplayName="Download Report" sap:VirtualizedContainerService.HintSize="881,1688" sap2010:WorkflowViewState.IdRef="Sequence_26">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="x:String" Name="strNewFileName" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="839,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_8" LogLevel="Info" LogMessage="Opening New Tab..." />
                                        <ui:MultipleAssign DisplayName="Multiple Assign: New File Name" sap:VirtualizedContainerService.HintSize="839,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_7">
                                          <ui:MultipleAssign.AssignOperations>
                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_43">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="x:String">[strNewFileName]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="x:String">[String.Join("_"c, {strFirstName, strLastName, strItemId, DateTime.Now.ToString("MMddyyyy_HHmmss")}) + ".pdf"]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_44">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="x:String">[strNewFileName]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="x:String">[String.Join("", strNewFileName.Split(Path.GetInvalidFileNameChars()))]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                            </scg:List>
                                          </ui:MultipleAssign.AssignOperations>
                                        </ui:MultipleAssign>
                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" Hidden="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Open Browser: PDF" sap:VirtualizedContainerService.HintSize="839,1365" sap2010:WorkflowViewState.IdRef="OpenBrowser_1" NewSession="True" Private="True" Url="[&quot;https://solarisdx.limsabc.com/?page=external_requisition_viewReport_name&amp;ids=&amp;radio=1&amp;filter_day_all=0&amp;model=Requisition&amp;last_id=&quot; + strRID]">
                                          <ui:OpenBrowser.Body>
                                            <ActivityAction x:TypeArguments="x:Object">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Download PDF" sap:VirtualizedContainerService.HintSize="805,1264" sap2010:WorkflowViewState.IdRef="Sequence_20">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="x:Boolean" Name="boolExistsPDF" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="763,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_13" LogLevel="Info" LogMessage="[&quot;Saving report PDF to [&quot; + strPathSaves + &quot;]...&quot;]" />
                                                <ui:UiElementExists DisplayName="Element Exists 'PDF Document'" Exists="[boolExistsPDF]" sap:VirtualizedContainerService.HintSize="763,68" sap2010:WorkflowViewState.IdRef="UiElementExists_2">
                                                  <ui:UiElementExists.Target>
                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="a47b60ed-498f-4eae-8707-11c358b5b2b2" Selector="&lt;wnd app='chrome.exe' cls='Chrome_WidgetWin_1' title='https://solarisdx.limsabc.com/?page=external_requisition_viewRep*' /&gt;&lt;ctrl name='*PDF document*' role='document' /&gt;">
                                                      <ui:Target.TimeoutMS>
                                                        <InArgument x:TypeArguments="x:Int32" />
                                                      </ui:Target.TimeoutMS>
                                                      <ui:Target.WaitForReady>
                                                        <InArgument x:TypeArguments="ui:WaitForReady" />
                                                      </ui:Target.WaitForReady>
                                                    </ui:Target>
                                                  </ui:UiElementExists.Target>
                                                </ui:UiElementExists>
                                                <If Condition="[boolExistsPDF]" DisplayName="If: PDF Loaded" sap:VirtualizedContainerService.HintSize="763,1002" sap2010:WorkflowViewState.IdRef="If_2">
                                                  <If.Then>
                                                    <Sequence DisplayName="Save PDF" sap:VirtualizedContainerService.HintSize="476,855" sap2010:WorkflowViewState.IdRef="Sequence_18">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="si:FileInfo" Name="fileResult" />
                                                      </Sequence.Variables>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:SendHotkey ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" SpecialKey="{x:Null}" Activate="True" DisplayName="Send Hotkey: Save As" sap:VirtualizedContainerService.HintSize="434,116" sap2010:WorkflowViewState.IdRef="SendHotkey_5" Key="s" KeyModifiers="Ctrl">
                                                        <ui:SendHotkey.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" Id="c2344e24-23ec-4bf5-ba9c-9eec8f696f14">
                                                            <ui:Target.TimeoutMS>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:Target.TimeoutMS>
                                                            <ui:Target.WaitForReady>
                                                              <InArgument x:TypeArguments="ui:WaitForReady" />
                                                            </ui:Target.WaitForReady>
                                                          </ui:Target>
                                                        </ui:SendHotkey.Target>
                                                      </ui:SendHotkey>
                                                      <ui:GetLastDownloadedFile Timeout="{x:Null}" DisplayName="Download File: Report PDF" DownloadFolder="[strPathSaves]" File="[fileResult]" sap:VirtualizedContainerService.HintSize="434,383" sap2010:WorkflowViewState.IdRef="GetLastDownloadedFile_2">
                                                        <ui:GetLastDownloadedFile.Body>
                                                          <ActivityAction>
                                                            <Sequence DisplayName="Save File" sap:VirtualizedContainerService.HintSize="242,176" sap2010:WorkflowViewState.IdRef="Sequence_17">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_14" LogLevel="Info" LogMessage="Downloading..." />
                                                              <ed:Chrome_Save_As DisplayName="Chrome Save As: PDF Result" FileName="[strNewFileName]" FilePath="[strPathSaves]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Chrome_Save_As_3" Overwrite="True" />
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:GetLastDownloadedFile.Body>
                                                      </ui:GetLastDownloadedFile>
                                                      <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="434,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_15" LogLevel="Info" LogMessage="Downloaded!" />
                                                      <Assign DisplayName="Assign: Generic Username" sap:VirtualizedContainerService.HintSize="434,60" sap2010:WorkflowViewState.IdRef="Assign_2">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[strFullPathPage]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[fileResult.FullName.Replace(Environment.UserName, "%USERNAME%")]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <ui:CloseTab Browser="{x:Null}" DisplayName="Close Tab" sap:VirtualizedContainerService.HintSize="434,22" sap2010:WorkflowViewState.IdRef="CloseTab_4" />
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Sequence DisplayName="PDF Not Loaded" sap:VirtualizedContainerService.HintSize="242,176" sap2010:WorkflowViewState.IdRef="Sequence_19">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:CloseTab Browser="{x:Null}" DisplayName="Close Tab" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="CloseTab_5" />
                                                      <Throw DisplayName="Throw: PDF Not Loaded" Exception="[New Exception(&quot;PDF Report did not load!&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_2" />
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:OpenBrowser.Body>
                                        </ui:OpenBrowser>
                                      </Sequence>
                                    </If.Then>
                                    <If.Else>
                                      <ui:MultipleAssign DisplayName="Multiple Assign: Rejected" sap:VirtualizedContainerService.HintSize="338,129" sap2010:WorkflowViewState.IdRef="MultipleAssign_13">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_64">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[strResult]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">Rejected</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_65">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[strFullPathPage]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">No File</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                    </If.Else>
                                  </If>
                                  <Sequence DisplayName="Add to Queue" sap:VirtualizedContainerService.HintSize="1264,238" sap2010:WorkflowViewState.IdRef="Sequence_13">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_6" LogLevel="Info" LogMessage="Adding to Dispatcher ..." />
                                    <ui:AddQueueItem ServiceBaseAddress="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Add Queue Item" DueDate="[datetimeResult.AddDays(1)]" FolderPath="[dicConfig(strQueueNameDispatcher).Item1]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddQueueItem_3" Priority="Normal" QueueType="[dicConfig(strQueueNameDispatcher).Item2]" Reference="[String.Join(&quot;_&quot;, {strItemId, strFirstName, strLastName})]">
                                      <ui:AddQueueItem.ItemInformation>
                                        <InArgument x:TypeArguments="x:String" x:Key="CurrentFolder">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="dicConfig(strQueueNameDispatcher).Item1" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="DateTimeAdded">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="DateTime.Now.ToString(&quot;M/dd/yyyy HH:mm:ss&quot;)" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="Source">
                                          <Literal x:TypeArguments="x:String">SolarisLab</Literal>
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="ItemId">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strItemId" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="DateTimeReceived">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="DateTime.Now.ToString(&quot;M/dd/yyyy HH:mm:ss&quot;)" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="Lab">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strLab" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="ContactType">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strContactType" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="ContactFacility">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strContactFacility" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="FirstName">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strFirstName" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="LastName">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strLastName" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="ContactDOB">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strContactDOB" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="DateTimeCollected">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strDateCollected" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="Result">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strResult" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="DateTimeResult">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strDateResult" />
                                        </InArgument>
                                        <InArgument x:TypeArguments="x:String" x:Key="FullPathPage">
                                          <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="strFullPathPage" />
                                        </InArgument>
                                      </ui:AddQueueItem.ItemInformation>
                                    </ui:AddQueueItem>
                                    <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[row.ItemArray]" DataTable="[dtDispatchedResult]" DisplayName="Add Data Row" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddDataRow_1" />
                                  </Sequence>
                                  <If Condition="[(intIndex + 1) Mod 15 = 0]" DisplayName="If: Dispatched 15" sap:VirtualizedContainerService.HintSize="1264,669" sap2010:WorkflowViewState.IdRef="If_3">
                                    <If.Then>
                                      <Sequence DisplayName="Mark as Dispatched" sap:VirtualizedContainerService.HintSize="418,522" sap2010:WorkflowViewState.IdRef="Sequence_22">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="376,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_16" LogLevel="Info" LogMessage="Appending 15 rows to Dispatched..." />
                                        <ui:RetryScope DisplayName="Retry Scope: Append to CSV" sap:VirtualizedContainerService.HintSize="376,306" sap2010:WorkflowViewState.IdRef="RetryScope_6" NumberOfRetries="300" RetryInterval="00:00:01">
                                          <ui:RetryScope.ActivityBody>
                                            <ActivityAction>
                                              <ui:AppendCsvFile Encoding="{x:Null}" DataTable="[dtDispatchedResult]" Delimitator="Comma" DisplayName="Append to CSV" FilePath="[strPathProcessedResults]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendCsvFile_4" />
                                            </ActivityAction>
                                          </ui:RetryScope.ActivityBody>
                                          <ui:RetryScope.Condition>
                                            <ActivityFunc x:TypeArguments="x:Boolean" />
                                          </ui:RetryScope.Condition>
                                        </ui:RetryScope>
                                        <ui:ClearDataTable DataTable="[dtDispatchedResult]" DisplayName="Clear Data Table" sap:VirtualizedContainerService.HintSize="376,22" sap2010:WorkflowViewState.IdRef="ClearDataTable_1" />
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                  <Sequence DisplayName="Formatting" sap:VirtualizedContainerService.HintSize="1264,451" sap2010:WorkflowViewState.IdRef="Sequence_12">
                                    <Sequence.Variables>
                                      <Variable x:TypeArguments="x:String" Name="strContactColor" />
                                    </Sequence.Variables>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Switch x:TypeArguments="x:String" DisplayName="Switch: Contact Color" Expression="[strContactType]" sap:VirtualizedContainerService.HintSize="497,159" sap2010:WorkflowViewState.IdRef="Switch`1_1">
                                      <Switch.Default>
                                        <ui:MultipleAssign DisplayName="Multiple Assign: Formatting" sap:VirtualizedContainerService.HintSize="338,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_11">
                                          <ui:MultipleAssign.AssignOperations>
                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_53">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="x:String">[strContactColor]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="x:String">ff6600</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                            </scg:List>
                                          </ui:MultipleAssign.AssignOperations>
                                        </ui:MultipleAssign>
                                      </Switch.Default>
                                      <ui:MultipleAssign x:Key="Staff" DisplayName="Multiple Assign: Formatting" sap:VirtualizedContainerService.HintSize="338,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_9">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_51">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[strContactColor]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">008000</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                      <ui:MultipleAssign x:Key="Resident" DisplayName="Multiple Assign: Formatting" sap:VirtualizedContainerService.HintSize="338,98" sap2010:WorkflowViewState.IdRef="MultipleAssign_10">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_52">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[strContactColor]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">800080</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                    </Switch>
                                    <ui:MultipleAssign DisplayName="Multiple Assign: Formatting" sap:VirtualizedContainerService.HintSize="497,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_12">
                                      <ui:MultipleAssign.AssignOperations>
                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_54">
                                            <ui:AssignOperation.To>
                                              <OutArgument x:TypeArguments="x:String">[strResult]</OutArgument>
                                            </ui:AssignOperation.To>
                                            <ui:AssignOperation.Value>
                                              <InArgument x:TypeArguments="x:String">[If (Not strResult.ToLower.Contains("negative"), "&lt;span style=""color: #ff0000;""&gt;&lt;strong&gt;" + strResult + "&lt;/strong&gt;&lt;/span&gt;", strResult)]</InArgument>
                                            </ui:AssignOperation.Value>
                                          </ui:AssignOperation>
                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_55">
                                            <ui:AssignOperation.To>
                                              <OutArgument x:TypeArguments="x:String">[strContactType]</OutArgument>
                                            </ui:AssignOperation.To>
                                            <ui:AssignOperation.Value>
                                              <InArgument x:TypeArguments="x:String">["&lt;span style=""color: #" + strContactColor + ";""&gt;&lt;strong&gt;" + strContactType +"&lt;/strong&gt;&lt;/span&gt;"]</InArgument>
                                            </ui:AssignOperation.Value>
                                          </ui:AssignOperation>
                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_56">
                                            <ui:AssignOperation.To>
                                              <OutArgument x:TypeArguments="x:String">[strSuccessMessage]</OutArgument>
                                            </ui:AssignOperation.To>
                                            <ui:AssignOperation.Value>
                                              <InArgument x:TypeArguments="x:String">["[" + String.Join("] [", {"ID: " + strItemId, "Type: " + strContactType, "Name: " + strFirstName + " " + strLastName, "DOB: " + strContactDOB, "Date Collected: " + strDateCollected, "Result: " + strResult, "Date Result: " + strDateresult}) + "]"]</InArgument>
                                            </ui:AssignOperation.Value>
                                          </ui:AssignOperation>
                                        </scg:List>
                                      </ui:MultipleAssign.AssignOperations>
                                    </ui:MultipleAssign>
                                  </Sequence>
                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Log Item Status workflow" sap:VirtualizedContainerService.HintSize="1264,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="Workflows\EZFramework\Orchestrator\Log Item Status.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InArgument x:TypeArguments="x:String" x:Key="strSuccessMessage">[strSuccessMessage]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="strFailMessage" />
                                      <InArgument x:TypeArguments="x:Boolean" x:Key="boolSuccess">True</InArgument>
                                      <InArgument x:TypeArguments="x:Boolean" x:Key="boolBusinessFailure">False</InArgument>
                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, s:Tuple(x:String, x:String))" x:Key="dicConfig">[dicConfig]</InArgument>
                                      <InArgument x:TypeArguments="ui:QueueItem" x:Key="itemTransaction" />
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                </Sequence>
                              </TryCatch.Try>
                              <TryCatch.Catches>
                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1310,21" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ActivityAction x:TypeArguments="s:Exception">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Error" sap:VirtualizedContainerService.HintSize="242,176" sap2010:WorkflowViewState.IdRef="Sequence_11">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <el:Log_Failed_Activity DisplayName="Log Failed Activity" ExceptionType="Application" ExceptionsList="[listExceptions]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Log_Failed_Activity_2" LogMessage="[exception.Source + &quot;: &quot; + exception.Message]" />
                                      <Rethrow sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Rethrow_1" />
                                    </Sequence>
                                  </ActivityAction>
                                </Catch>
                              </TryCatch.Catches>
                            </TryCatch>
                          </ActivityAction>
                        </ui:RetryScope.ActivityBody>
                        <ui:RetryScope.Condition>
                          <ActivityFunc x:TypeArguments="x:Boolean" />
                        </ui:RetryScope.Condition>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:RetryScope>
                    </Sequence>
                  </ActivityAction>
                </ui:ForEachRow.Body>
              </ui:ForEachRow>
            </ActivityAction>
          </ui:BrowserScope.Body>
        </ui:BrowserScope>
      </TryCatch.Try>
      <TryCatch.Catches>
        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="422,21" sap2010:WorkflowViewState.IdRef="Catch`1_2">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ActivityAction x:TypeArguments="s:Exception">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
            </ActivityAction.Argument>
            <Sequence DisplayName="Error" sap:VirtualizedContainerService.HintSize="242,176" sap2010:WorkflowViewState.IdRef="Sequence_21">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <el:Log_Failed_Activity DisplayName="Log Failed Activity" ExceptionType="Application" ExceptionsList="[listExceptions]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Log_Failed_Activity_3" LogMessage="[exception.Source + &quot;: &quot; + exception.Message]" />
              <Rethrow sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Rethrow_2" />
            </Sequence>
          </ActivityAction>
        </Catch>
      </TryCatch.Catches>
      <TryCatch.Finally>
        <Sequence DisplayName="Append Any Processed" sap:VirtualizedContainerService.HintSize="418,460" sap2010:WorkflowViewState.IdRef="Sequence_25">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <el:Append_to_Log DisplayName="Append to Log" sap:VirtualizedContainerService.HintSize="376,22" sap2010:WorkflowViewState.IdRef="Append_to_Log_18" LogLevel="Info" LogMessage="Appending Dispatched to CSV..." />
          <ui:RetryScope DisplayName="Retry Scope: Append to CSV" sap:VirtualizedContainerService.HintSize="376,306" sap2010:WorkflowViewState.IdRef="RetryScope_5" NumberOfRetries="300" RetryInterval="00:00:01">
            <ui:RetryScope.ActivityBody>
              <ActivityAction>
                <ui:AppendCsvFile Encoding="{x:Null}" DataTable="[dtDispatchedResult]" Delimitator="Comma" DisplayName="Append to CSV" FilePath="[strPathProcessedResults]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendCsvFile_3" />
              </ActivityAction>
            </ui:RetryScope.ActivityBody>
            <ui:RetryScope.Condition>
              <ActivityFunc x:TypeArguments="x:Boolean" />
            </ui:RetryScope.Condition>
          </ui:RetryScope>
        </Sequence>
      </TryCatch.Finally>
    </TryCatch>
  </Sequence>
</Activity>